
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../api/face-warp/">
      
      
        <link rel="next" href="../face/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.28">
    
    
      
        <title>Random speech - CLEESE, a Python toolbox for randomizing stimuli</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tutorial-random-speech-generation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="CLEESE, a Python toolbox for randomizing stimuli" class="md-header__button md-logo" aria-label="CLEESE, a Python toolbox for randomizing stimuli" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M184 0c30.9 0 56 25.1 56 56v400c0 30.9-25.1 56-56 56-28.9 0-52.7-21.9-55.7-50.1-5.2 1.4-10.7 2.1-16.3 2.1-35.3 0-64-28.7-64-64 0-7.4 1.3-14.6 3.6-21.2C21.4 367.4 0 338.2 0 304c0-31.9 18.7-59.5 45.8-72.3C37.1 220.8 32 207 32 192c0-30.7 21.6-56.3 50.4-62.6C80.8 123.9 80 118 80 112c0-29.9 20.6-55.1 48.3-62.1 3-28 26.8-49.9 55.7-49.9zm144 0c28.9 0 52.6 21.9 55.7 49.9C411.5 56.9 432 82 432 112c0 6-.8 11.9-2.4 17.4 28.8 6.2 50.4 31.9 50.4 62.6 0 15-5.1 28.8-13.8 39.7 27.1 12.8 45.8 40.4 45.8 72.3 0 34.2-21.4 63.4-51.6 74.8 2.3 6.6 3.6 13.8 3.6 21.2 0 35.3-28.7 64-64 64-5.6 0-11.1-.7-16.3-2.1-3 28.2-26.8 50.1-55.7 50.1-30.9 0-56-25.1-56-56V56c0-30.9 25.1-56 56-56z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CLEESE, a Python toolbox for randomizing stimuli
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Random speech
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/neuro-team-femto/cleese" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    neuro-team-femto/cleese
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../installation/" class="md-tabs__link">
        
  
    
  
  Getting started

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api/general/" class="md-tabs__link">
          
  
  Functions

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../about/" class="md-tabs__link">
        
  
    
  
  About CLEESE

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="CLEESE, a Python toolbox for randomizing stimuli" class="md-nav__button md-logo" aria-label="CLEESE, a Python toolbox for randomizing stimuli" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M184 0c30.9 0 56 25.1 56 56v400c0 30.9-25.1 56-56 56-28.9 0-52.7-21.9-55.7-50.1-5.2 1.4-10.7 2.1-16.3 2.1-35.3 0-64-28.7-64-64 0-7.4 1.3-14.6 3.6-21.2C21.4 367.4 0 338.2 0 304c0-31.9 18.7-59.5 45.8-72.3C37.1 220.8 32 207 32 192c0-30.7 21.6-56.3 50.4-62.6C80.8 123.9 80 118 80 112c0-29.9 20.6-55.1 48.3-62.1 3-28 26.8-49.9 55.7-49.9zm144 0c28.9 0 52.6 21.9 55.7 49.9C411.5 56.9 432 82 432 112c0 6-.8 11.9-2.4 17.4 28.8 6.2 50.4 31.9 50.4 62.6 0 15-5.1 28.8-13.8 39.7 27.1 12.8 45.8 40.4 45.8 72.3 0 34.2-21.4 63.4-51.6 74.8 2.3 6.6 3.6 13.8 3.6 21.2 0 35.3-28.7 64-64 64-5.6 0-11.1-.7-16.3-2.1-3 28.2-26.8 50.1-55.7 50.1-30.9 0-56-25.1-56-56V56c0-30.9 25.1-56 56-56z"/></svg>

    </a>
    CLEESE, a Python toolbox for randomizing stimuli
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/neuro-team-femto/cleese" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    neuro-team-femto/cleese
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Functions
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Functions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/general/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/phase-vocoder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phase Vocoder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/face-warp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Face Warp
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Random speech
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Random speech
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#6-random-variants-of-french-phase-je-suis-en-route-pour-la-reunion-im-on-my-way-to-the-meeting" class="md-nav__link">
    <span class="md-ellipsis">
      6 random variants of French phase "je suis en route pour la réunion" (I'm on my way to the meeting)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preambule" class="md-nav__link">
    <span class="md-ellipsis">
      Preambule
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Preambule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#verify-your-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Verify your installation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#useful-imports" class="md-nav__link">
    <span class="md-ellipsis">
      Useful imports
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#useful-files" class="md-nav__link">
    <span class="md-ellipsis">
      Useful files
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-sound-manipulation-with-cleese" class="md-nav__link">
    <span class="md-ellipsis">
      Basic sound manipulation with CLEESE
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Basic sound manipulation with CLEESE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#random-pitch-profile-in-a-single-utterance" class="md-nav__link">
    <span class="md-ellipsis">
      Random pitch profile in a single utterance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#random-speed-profile-in-a-song" class="md-nav__link">
    <span class="md-ellipsis">
      Random speed profile in a song
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batched-transforms" class="md-nav__link">
    <span class="md-ellipsis">
      Batched transforms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chained-transforms" class="md-nav__link">
    <span class="md-ellipsis">
      Chained transforms
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-use" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced use
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced use">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flattening-files" class="md-nav__link">
    <span class="md-ellipsis">
      Flattening files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-custom-breakpoints" class="md-nav__link">
    <span class="md-ellipsis">
      Using custom breakpoints
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../face/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Random faces
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../morphing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Morphing between words
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About CLEESE
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#6-random-variants-of-french-phase-je-suis-en-route-pour-la-reunion-im-on-my-way-to-the-meeting" class="md-nav__link">
    <span class="md-ellipsis">
      6 random variants of French phase "je suis en route pour la réunion" (I'm on my way to the meeting)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preambule" class="md-nav__link">
    <span class="md-ellipsis">
      Preambule
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Preambule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#verify-your-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Verify your installation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#useful-imports" class="md-nav__link">
    <span class="md-ellipsis">
      Useful imports
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#useful-files" class="md-nav__link">
    <span class="md-ellipsis">
      Useful files
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-sound-manipulation-with-cleese" class="md-nav__link">
    <span class="md-ellipsis">
      Basic sound manipulation with CLEESE
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Basic sound manipulation with CLEESE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#random-pitch-profile-in-a-single-utterance" class="md-nav__link">
    <span class="md-ellipsis">
      Random pitch profile in a single utterance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#random-speed-profile-in-a-song" class="md-nav__link">
    <span class="md-ellipsis">
      Random speed profile in a song
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batched-transforms" class="md-nav__link">
    <span class="md-ellipsis">
      Batched transforms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chained-transforms" class="md-nav__link">
    <span class="md-ellipsis">
      Chained transforms
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-use" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced use
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced use">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flattening-files" class="md-nav__link">
    <span class="md-ellipsis">
      Flattening files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-custom-breakpoints" class="md-nav__link">
    <span class="md-ellipsis">
      Using custom breakpoints
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/neuro-team-femto/cleese/edit/main/docs/docs/tutorials/speech.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
    </a>
  
  


<h1 id="tutorial-random-speech-generation">Tutorial: random speech generation<a class="headerlink" href="#tutorial-random-speech-generation" title="Permanent link">&para;</a></h1>
<p>This tutorial shows how to use CLEESE's <code>PhaseVocoder</code> engine to generate a arbitrary number of expressive variations around an original speech recording.</p>
<h6 id="6-random-variants-of-french-phase-je-suis-en-route-pour-la-reunion-im-on-my-way-to-the-meeting">6 random variants of French phase <em>"je suis en route pour la réunion"</em> (I'm on my way to the meeting)<a class="headerlink" href="#6-random-variants-of-french-phase-je-suis-en-route-pour-la-reunion-im-on-my-way-to-the-meeting" title="Permanent link">&para;</a></h6>
<p><audio controls src="../sounds/variation_pitch.wav"></audio><br>
<a href="../sounds/variation_pitch.wav"> Download audio </a></p>
<h2 id="preambule">Preambule<a class="headerlink" href="#preambule" title="Permanent link">&para;</a></h2>
<h3 id="verify-your-installation">Verify your installation<a class="headerlink" href="#verify-your-installation" title="Permanent link">&para;</a></h3>
<p>Before starting, please verify that you have a working CLEESE installation, by running the following cell which you return without error. </p>
<p><div class="language-py highlight"><span class="filename">import cleese</span><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span> <span class="nn">cleese_stim</span> <span class="k">as</span> <span class="nn">cleese</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span> <span class="nn">cleese_stim.engines</span> <span class="kn">import</span> <span class="n">PhaseVocoder</span>
</span></code></pre></div>
Check the <a href="../../installation">installation instructions</a> if needed. </p>
<h3 id="useful-imports">Useful imports<a class="headerlink" href="#useful-imports" title="Permanent link">&para;</a></h3>
<p>The following code imports all the python packages that are needed in the rest of this tutorial (which you can <code>pip install</code> if you don't have them already). </p>
<div class="language-py highlight"><span class="filename">extra imports</span><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></code></pre></div>
<h3 id="useful-files">Useful files<a class="headerlink" href="#useful-files" title="Permanent link">&para;</a></h3>
<p>In the following, we'll be a number of files which you'll first need to download and store in your path at the indicated place</p>
<ul>
<li><a href="../sounds/male_vraiment_flattened.wav">male_vraiment_flattened.wav</a> <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg></span> <code>./sounds/male_vraiment_flattened.wav</code> </li>
<li><a href="../configs/random_pitch_profile.toml">random_pitch_profile.toml</a> <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg></span> <code>./configs/random_pitch_profile.toml</code></li>
<li><a href="../sounds/female_anniversaire_isochrone.wav">female_anniversaire_isochrone.wav</a> <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg></span> <code>./sounds/female_anniversaire_isochrone.wav</code></li>
<li><a href="../configs/random_speed_profile.toml">random_speed_profile.toml</a> <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg></span> <code>./configs/random_speed_profile.toml</code></li>
<li><a href="../configs/chained_pitch_stretch.toml">chained_pitch_stretch.toml</a> :material-arrow-right <code>./configs/chained_pitch_stretch.toml</code></li>
<li><a href="../sounds/male_vraiment_original.wav">male_vraiment_original.wav</a> <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg></span> <code>./sounds/male_vraiment_original.wav</code> </li>
</ul>
<h2 id="basic-sound-manipulation-with-cleese">Basic sound manipulation with CLEESE<a class="headerlink" href="#basic-sound-manipulation-with-cleese" title="Permanent link">&para;</a></h2>
<h3 id="random-pitch-profile-in-a-single-utterance">Random pitch profile in a single utterance<a class="headerlink" href="#random-pitch-profile-in-a-single-utterance" title="Permanent link">&para;</a></h3>
<p>The most basic usage scenario of CLEESE is to input a single recording (ex. the French word "vraiment" - "really", recorded by a single male speaker)</p>
<p><audio controls src="../sounds/male_vraiment_flattened.wav"></audio><br>
<a href="../sounds/male_vraiment_flattened.wav"> Download audio </a></p>
<p>and use CLEESE to transform the sound with a random pitch profile. This, like all cleese operations, is done by passing to the main cleese function <code>cleese.process_data</code> a configuration file (<a href="../configs/random_pitch_profile.toml">random_pitch_profile.toml</a>) which specifies the manipulation we want. Here: cut the file in <code>pitch.window.count = 6</code> time segments, draw a random pitch shift factor at each segment boundary from a Gaussian distribution centered on 0 and standard deviation <code>pitch.std = 300</code>cents, and interpolate between segment boundaries using linear <code>pitch.BPFType = "ramp"</code>. (See <a href="../../api/phase-vocoder/">PhaseVocoder</a> documentation for more information)</p>
<div class="language-toml highlight"><span class="filename">random_pitch_profile.toml</span><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">[pitch]</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="c1"># pitch transposition window in seconds. If 0 : static transformation</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">window</span><span class="p">.</span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.11</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="c1"># number of pitch transposition windows. If 0 : static transformation</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="n">window</span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="c1"># &#39;s&#39;: force winlength in seconds,&#39;n&#39;: force number of windows (equal length)</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="n">window</span><span class="p">.</span><span class="n">unit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;n&#39;</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="c1"># standard deviation (cents) for random transposisiton (Gaussian distrib for now)</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="n">std</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">300</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="c1"># truncate distribution values (factor of std)</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="n">trunc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="c1"># type of breakpoint function:</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a><span class="c1">#      &#39;ramp&#39;: linear interpolation between breakpoints</span>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="c1">#      &#39;square&#39;: square BPF, with specified transition times at edges</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a><span class="n">BPFtype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ramp&#39;</span>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a><span class="c1"># in s: transition time for square BPF</span>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a><span class="n">trTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.02</span>
</span></code></pre></div>
<p>The following code is pretty much all there is to call: <code>cleese.process_data</code> takes in the <code>Engine</code> that is called on to do the transformation (here, <code>PhaseVocoder</code> - see the <a href="../face">Image tutorial</a> for a similar call to image-transformation engine <code>FaceWarp</code>), the array <code>wave_in</code> of audio data obtained from <code>PhaseVocoder.wav_read</code> and its sampling rate <code>sr</code>, and the path to the configuration file <code>config_file</code> that tells the <code>PhaseVocoder</code> engine what to do with it all. </p>
<div class="language-python highlight"><span class="filename">randomize pitch</span><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">input_file</span> <span class="o">=</span> <span class="s2">&quot;./sounds/male_vraiment_flattened.wav&quot;</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">config_file</span> <span class="o">=</span> <span class="s2">&quot;./configs/random_pitch_profile.toml&quot;</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="c1"># read input wavefile</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="n">wave_in</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">PhaseVocoder</span><span class="o">.</span><span class="n">wav_read</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="c1"># transform sound</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="n">wave_out</span><span class="p">,</span><span class="n">bpf_out</span> <span class="o">=</span> <span class="n">cleese</span><span class="o">.</span><span class="n">process_data</span><span class="p">(</span><span class="n">PhaseVocoder</span><span class="p">,</span> <span class="n">wave_in</span><span class="p">,</span> <span class="n">config_file</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">sr</span><span class="p">)</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="c1"># save file if necessary</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="n">output_file</span> <span class="o">=</span> <span class="s2">&quot;./sounds/male_vraiment_flattened_transformed.wav&quot;</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="n">PhaseVocoder</span><span class="o">.</span><span class="n">wav_write</span><span class="p">(</span><span class="n">wave_out</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">sr</span><span class="p">)</span>
</span></code></pre></div>
<p><audio controls src="../sounds/male_vraiment_flattened_transformed.wav"></audio><br>
<a href="../sounds/male_vraiment_flattened_transformed.wav"> Download audio </a></p>
<p>The <code>bpf_out</code> output describes the break-point function that was generated randomly by CLEESE and used to transform <code>wave_in</code> to <code>wave_out</code>. It is a simple array of times and values pairs, each corresponding to the timepoint in the file of a breakpoint and the corresponding pitch transformation values applied at this point (for more on BPFs, see the <a href="../../api/phase-vocoder/#bpfs">PhaseVocoder documentation</a>).  </p>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nb">print</span><span class="p">(</span><span class="n">bpf_out</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>[[ 0.00000000e+00 -1.01767821e+02]
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a> [ 7.10430839e-02 -9.91175403e+01]
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a> [ 1.42086168e-01  1.07735422e+02]
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a> [ 2.13129252e-01 -3.87725633e+01]
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a> [ 2.84172336e-01  5.15893896e+01]
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a> [ 3.55215420e-01  1.46774252e+02]
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a> [ 4.26258503e-01 -5.06624397e+00]]
</span></code></pre></div>
Here, one sees that the file duration is about 426ms and that, consistently with the <code>window.count = 6</code> parameter in the config file, the transformation uses 7 breakpoints, i.e. 6 segments. Each breakpoint is associated a pitch transformation value in cents which, here, was assigned random samples ranging between -101.7 and +146.7, which is consistent with the <code>std = 300</code> parameter in the config_file. The general shape of the transformation, in that specific random instance, is to reduce the beginning of the sound by ca. 100 cents (i.e. - 1 semitone), then increase it by +100 cents (compared to baseline) around 142ms, down again at 213ms, back up to +146cents at 355ms, i.e. a shape that is roughly that of letter W. Of course, every call to the same code will generate a new, random bpf and transformation. </p>
<div class="admonition note">
<p class="admonition-title">About cents</p>
<p>Cents are a relative unit of frequency which corresponds to 1% of a musical semitone. Increasing a frequency <span class="arithmatex">\(f_1\)</span> by <span class="arithmatex">\(+n\)</span> cents results in <span class="arithmatex">\(f_2 = f_1 * 2^{n/1200}\)</span>. Increasing sound's pitch by +100cents is equivalent to raising it by 1 semitone (<span class="arithmatex">\(f_1*2^{1/12})\)</span>, i.e. the same as going from musical notes C to C#. A change of 12 semitone (1200 cents) corresponds to going up one octave (e.g. C3 <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg></span> C4), corresponding to doubling frequency (<span class="arithmatex">\(f_1 * 2^{1200/1200}\)</span>). In speech, pitch changes of the order of 100-200 cents are considered large; a static change of +50cents is often sufficient to evoke e.g. the impression of happier speech (<a href="https://link.springer.com/article/10.3758/s13428-017-0873-y">Rachman et al. 2018</a>). Technically, CLEESE's <code>PhaseVocoder</code> engine implements a relatively straightforward version of the phase vocoder algorithm (phase locking with frame-wise peak picking and no spectral envelope conservation, see e.g. <a href="https://ieeexplore.ieee.org/abstract/document/759041">Laroche and Dolson, 1999</a>), and will likely generate artifacts such as phasiness for transformations larger than 150-200 cents (which may or may not be a problem depending on your usage scenario) </p>
</div>
<p>CLEESE's <code>PhaseVocoder</code> includes a utility for extracting pitch in speech/audio files (<code>PhaseVocoder.extract_pitch</code>), which uses the YIN pitch extraction algorithm, and can be used to visualize the pitch profile of sounds before and after manipulation. This is just for visualization purposes, and isn't necessary for the working of the main <code>cleese.process</code> function above. </p>
<div class="language-py highlight"><span class="filename">visualize pitch before/after</span><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># extract pitch before transformation</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="n">times_in</span><span class="p">,</span><span class="n">pitch_in</span> <span class="o">=</span> <span class="n">PhaseVocoder</span><span class="o">.</span><span class="n">extract_pitch</span><span class="p">(</span><span class="n">wave_in</span><span class="p">,</span><span class="n">sr</span><span class="p">)</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="c1"># extract pitch after transformation</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="n">times_out</span><span class="p">,</span><span class="n">pitch_out</span> <span class="o">=</span> <span class="n">PhaseVocoder</span><span class="o">.</span><span class="n">extract_pitch</span><span class="p">(</span><span class="n">wave_out</span><span class="p">,</span><span class="n">sr</span><span class="p">)</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="c1"># display </span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times_in</span><span class="p">,</span> <span class="n">pitch_in</span><span class="p">,</span> <span class="s1">&#39;k:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pre&#39;</span><span class="p">)</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times_out</span><span class="p">,</span> <span class="n">pitch_out</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">)</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time in file (ms)&#39;</span><span class="p">)</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;pitch (Hz)&#39;</span><span class="p">)</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">70</span><span class="p">,</span><span class="mi">120</span><span class="p">])</span>
</span></code></pre></div>
<p><img alt="Image title" src="../../images/speech_tutorial_1.png" /></p>
<h3 id="random-speed-profile-in-a-song">Random speed profile in a song<a class="headerlink" href="#random-speed-profile-in-a-song" title="Permanent link">&para;</a></h3>
<p>CLEESE can process longer files than a single word and, instead of manipulating pitch, can manipulate the duration of each portion of the file. To demonstrate this, we use CLEESE to randomly stretch each note in a recording of a song (the French song "Joyeux Anniversaire" / "Happy Birthday", sung by a female singer)</p>
<p><audio controls src="../sounds/female_anniversaire_isochrone.wav"></audio><br>
<a href="../sounds/female_anniversaire_isochrone.wav"> Download audio </a></p>
<p>This, as above, is done by passing to <code>cleese.process_data</code> a configuration file which specifies the manipulation we want. Here: cut the file in <code>stretch.window.len = 0.5</code> second time segments, draw a random stretch shift factor at each segment boundary from a Gaussian distribution centered on 1.0 and standard deviation <code>stretch.std = 1.5</code> (where factors &gt;1 correspond to a time stretch, and factors &lt;1 correspond to a time compression), and interpolate between segment boundaries using linear <code>stretch.BPFType = "ramp"</code>. </p>
<div class="language-toml highlight"><span class="filename">random_speed_profile.toml</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">[stretch]</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="n">window</span><span class="p">.</span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="n">window</span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="n">window</span><span class="p">.</span><span class="n">unit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;n&#39;</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="c1"># stretching factor. &gt;1: expansion, &lt;1: compression</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="n">std</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.5</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="n">trunc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="n">BPFtype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ramp&#39;</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="n">trTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.05</span>
</span></code></pre></div>
<p>The following code runs the transformation</p>
<div class="language-python highlight"><span class="filename">randomize duration</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">input_file</span> <span class="o">=</span> <span class="s2">&quot;./sounds/female_anniversaire_isochrone.wav&quot;</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="n">config_file</span> <span class="o">=</span> <span class="s2">&quot;./configs/random_speed_profile.toml&quot;</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="c1"># read input wavefile</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="n">wave_in</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">PhaseVocoder</span><span class="o">.</span><span class="n">wav_read</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="c1"># CLEESE</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="n">wave_out</span><span class="p">,</span><span class="n">bpf_out</span> <span class="o">=</span> <span class="n">cleese</span><span class="o">.</span><span class="n">process_data</span><span class="p">(</span><span class="n">PhaseVocoder</span><span class="p">,</span> <span class="n">wave_in</span><span class="p">,</span> <span class="n">config_file</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">sr</span><span class="p">)</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="c1"># save file if necessary</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="n">output_file</span> <span class="o">=</span> <span class="s2">&quot;./sounds/female_anniversaire_isochrone_transformed.wav&quot;</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="n">PhaseVocoder</span><span class="o">.</span><span class="n">wav_write</span><span class="p">(</span><span class="n">wave_out</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">sr</span><span class="p">)</span>
</span></code></pre></div>
<p><audio controls src="../sounds/female_anniversaire_isochrone_transformed.wav"></audio><br>
<a href="../sounds/female_anniversaire_isochrone_transformed.wav"> Download audio </a></p>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nb">print</span><span class="p">(</span><span class="n">bpf_out</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>[[0.         0.72650135]
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a> [0.64062585 1.        ]
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a> [1.2812517  1.42662854]
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a> [1.92187755 1.16536151]
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a> [2.5625034  2.382554  ]
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a> [3.20312925 1.28544142]]
</span></code></pre></div></p>
<p>Again, inspection of the (randomly generated) BPF shows 5 segments/6 breakpoints, regularly spaced from t=0 to t=3.2 sec. The stretch values are generated with a gaussian distribution centered on 1 (1:1 ratio, corresponding to no change of duration) and, in that specific instance, are mostly &gt; 1, which explains that the sound above is longer than the original. The largest stretch (x2.38 in duration) occurs at the end of the sound, ca. 2.56sec, which can be heard in the longer final last 2 syllables (<em>/veeeer/saaaaaire/</em>) in the extract above.  </p>
<p>As above, one can use the <code>extract_pitch</code> utility to visualize the difference between the two files. Notice that, contrary to the <code>pitch</code> transform above, the actual pitch values in the two sounds are not changed, but only how they unfold in time. </p>
<div class="language-py highlight"><span class="filename">visualize before and after transform</span><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1"># extract pitch before transformation</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">times_in</span><span class="p">,</span><span class="n">pitch_in</span> <span class="o">=</span> <span class="n">PhaseVocoder</span><span class="o">.</span><span class="n">extract_pitch</span><span class="p">(</span><span class="n">wave_in</span><span class="p">,</span><span class="n">sr</span><span class="p">)</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="c1"># extract pitch after transformation</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="n">times_out</span><span class="p">,</span><span class="n">pitch_out</span> <span class="o">=</span> <span class="n">PhaseVocoder</span><span class="o">.</span><span class="n">extract_pitch</span><span class="p">(</span><span class="n">wave_out</span><span class="p">,</span><span class="n">sr</span><span class="p">)</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="c1"># display </span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times_in</span><span class="p">,</span> <span class="n">pitch_in</span><span class="p">,</span> <span class="s1">&#39;k:&#39;</span><span class="p">)</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times_out</span><span class="p">,</span> <span class="n">pitch_out</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">)</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time in file (ms)&#39;</span><span class="p">)</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;pitch (Hz)&#39;</span><span class="p">)</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span><span class="mi">310</span><span class="p">])</span>
</span></code></pre></div>
<p><img alt="Image title" src="../../images/speech_tutorial_2.png" /></p>
<h3 id="batched-transforms">Batched transforms<a class="headerlink" href="#batched-transforms" title="Permanent link">&para;</a></h3>
<p>Instead of generating output files one at a time, CLEESE can be used to generate large numbers of manipulated files, each randomly generated using parameters specified in config files as above. This is achieve by pusing cleese.generate_stimuli <code>cleese.generate_stimuli(PhaseVocoder, input_file, config_file)</code>. Output files are not returned by the function, but directly written in <code>main.outPath</code>, and the number of output files generated is given by <code>main.numFiles</code>, all of which are found in the configuration file:</p>
<div class="language-toml highlight"><span class="filename">random_pitch_profile.toml</span><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="k">[main]</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="c1"># output root folder</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="n">outPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;./output/&quot;</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="c1"># number of output files to generate (for random modifications)</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="n">numFiles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="c1"># apply transformation in series (True) or parallel (False)</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="n">chain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="c1"># transformations to apply</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="n">transf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;pitch&quot;</span><span class="p">]</span>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="c1"># generate experiment folder with name based on current time</span>
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="n">generateExpFolder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</span></code></pre></div>
<p>The following code will create 10 random transformations of the <code>input_file</code>, each with random parameters generated from <code>config_file</code>, and store both files and parameters in the <code>outPath</code> folder designated in <code>config_file</code> </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the <code>outPath</code> directory doesn't exist in your working directory, it will be created automatically. </p>
</div>
<div class="language-python highlight"><span class="filename">batch transform</span><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">input_file</span> <span class="o">=</span> <span class="s2">&quot;./sounds/male_vraiment_flattened.wav&quot;</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="n">config_file</span> <span class="o">=</span> <span class="s2">&quot;./configs/random_pitch_profile.toml&quot;</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="c1"># CLEESE</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="n">cleese</span><span class="o">.</span><span class="n">generate_stimuli</span><span class="p">(</span><span class="n">PhaseVocoder</span><span class="p">,</span> <span class="n">input_file</span><span class="p">,</span> <span class="n">config_file</span><span class="p">)</span>
</span></code></pre></div>
<p><audio controls src="../sounds/male_vraiment_flattened_transformed_1.wav"></audio> 
<a href="../sounds/male_vraiment_flattened_transformed_1.wav"> Download audio </a> <br>
<audio controls src="../sounds/male_vraiment_flattened_transformed_2.wav"></audio>
<a href="../sounds/male_vraiment_flattened_transformed_2.wav"> Download audio </a> <br>
<audio controls src="../sounds/male_vraiment_flattened_transformed_3.wav"></audio>
<a href="../sounds/male_vraiment_flattened_transformed_3.wav"> Download audio </a> <br>
<audio controls src="../sounds/male_vraiment_flattened_transformed_4.wav"></audio>
<a href="../sounds/male_vraiment_flattened_transformed_4.wav"> Download audio </a> <br>
...</p>
<h3 id="chained-transforms">Chained transforms<a class="headerlink" href="#chained-transforms" title="Permanent link">&para;</a></h3>
<p>CLEESE can process files with a series of transformations that follow each other, e.g. first time-stretch the file, then pitch-shift it. This is done by specifying keyword <code>chain = true</code> under the configuration section <code>[main]</code>, as well as the list of transformations to be applied, e.g. here <code>transf = ['pitch','stretch']</code>.  </p>
<div class="language-toml highlight"><span class="filename">chained_pitch_stretch.toml</span><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="k">[main]</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="c1"># output root folder</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="n">outPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;./output/&quot;</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="c1"># number of output files to generate (for random modifications)</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="n">numFiles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="c1"># apply transformation in series (True) or parallel (False)</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="n">chain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="c1"># transformations to apply</span>
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="n">transf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;pitch&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;stretch&quot;</span><span class="p">]</span>
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="c1"># generate experiment folder with name based on current time</span>
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="n">generateExpFolder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</span></code></pre></div>
<p>The following code runs a chained transformation (notice the change of <code>config_file</code>) on 10 files, and stores them all in the <code>outPath</code> folder designated in <code>config_file</code></p>
<div class="language-py highlight"><span class="filename">chained transform</span><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">input_file</span> <span class="o">=</span> <span class="s2">&quot;./sounds/male_vraiment_flattened.wav&quot;</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="n">config_file</span> <span class="o">=</span> <span class="s2">&quot;./configs/chained_pitch_stretch.toml&quot;</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="c1"># CLEESE</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="n">cleese</span><span class="o">.</span><span class="n">generate_stimuli</span><span class="p">(</span><span class="n">PhaseVocoder</span><span class="p">,</span> <span class="n">input_file</span><span class="p">,</span> <span class="n">config_file</span><span class="p">)</span>
</span></code></pre></div>
<p><audio controls src="../sounds/male_vraiment_flattened_transformed_5.wav"></audio> 
<a href="../sounds/male_vraiment_flattened_transformed_5.wav"> Download audio </a> <br>
<audio controls src="../sounds/male_vraiment_flattened_transformed_6.wav"></audio>
<a href="../sounds/male_vraiment_flattened_transformed_6.wav"> Download audio </a> <br>
<audio controls src="../sounds/male_vraiment_flattened_transformed_7.wav"></audio>
<a href="../sounds/male_vraiment_flattened_transformed_7.wav"> Download audio </a> <br>
<audio controls src="../sounds/male_vraiment_flattened_transformed_8.wav"></audio>
<a href="../sounds/male_vraiment_flattened_transformed_8.wav"> Download audio </a> <br></p>
<h2 id="advanced-use">Advanced use<a class="headerlink" href="#advanced-use" title="Permanent link">&para;</a></h2>
<h3 id="flattening-files">Flattening files<a class="headerlink" href="#flattening-files" title="Permanent link">&para;</a></h3>
<p>When applying CLEESE to generate stimuli for reverse correlation, it is often advisable to use base stimuli that are as flat as possible (e.g., if randomizing pitch, start with a sound that has constant pitch). CLEESE can be used to flatten an existing recording, using the trick of not letting the tool generate its own random breakpoint function, but rather providing it with a custom function that inverts the natural pitch variations found in the original file. We demonstrate this with an original, non flattened recording of the word "vraiment". </p>
<p>Start with a normal, non-flat recording of the same word ``vraiment'' as above: </p>
<p><audio controls src="../sounds/male_vraiment_original.wav"></audio><br>
<a href="../sounds/male_vraiment_original.wav"> Download audio </a></p>
<p>The file has a soft, down-ward pitch contour, as show here</p>
<div class="language-py highlight"><span class="filename">display original pitch</span><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">input_file</span> <span class="o">=</span> <span class="s2">&quot;./sounds/male_vraiment_original.wav&quot;</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="n">wave_in</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">PhaseVocoder</span><span class="o">.</span><span class="n">wav_read</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="n">times_in</span><span class="p">,</span><span class="n">pitch_in</span> <span class="o">=</span> <span class="n">PhaseVocoder</span><span class="o">.</span><span class="n">extract_pitch</span><span class="p">(</span><span class="n">wave_in</span><span class="p">,</span><span class="n">sr</span><span class="p">,</span> <span class="n">win</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">])</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times_in</span><span class="p">,</span> <span class="n">pitch_in</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time in file (ms)&#39;</span><span class="p">)</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;pitch&#39;</span><span class="p">)</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">80</span><span class="p">,</span><span class="mi">120</span><span class="p">])</span>
</span></code></pre></div>
<p><img alt="Image title" src="../../images/speech_tutorial_4.png" /></p>
<p>To flatten this existing contour, we construct a custom break-point function (bpf) that passes through the pitch shift values needed to shift the contour down to a constant pitch value, arbitrarily set here at 110Hz. </p>
<div class="language-py highlight"><span class="filename">custom bpf</span><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">mean_pitch</span> <span class="o">=</span> <span class="mf">110.</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="k">def</span> <span class="nf">difference_to_cents</span><span class="p">(</span><span class="n">pitch</span><span class="p">,</span> <span class="n">ref_pitch</span><span class="p">):</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>    <span class="k">if</span> <span class="n">pitch</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>        <span class="k">return</span> <span class="o">-</span><span class="mi">1200</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">pitch</span><span class="o">/</span><span class="n">ref_pitch</span><span class="p">)</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>        <span class="k">return</span> <span class="mi">1</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="n">bpf_times</span> <span class="o">=</span> <span class="n">times_in</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="n">bpf_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">difference_to_cents</span><span class="p">(</span><span class="n">hz</span><span class="p">,</span> <span class="n">mean_pitch</span><span class="p">)</span> <span class="k">for</span> <span class="n">hz</span> <span class="ow">in</span> <span class="n">pitch_in</span><span class="p">])</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="c1"># display original file</span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="n">bpf_times</span><span class="p">,</span> <span class="n">bpf_val</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time in file (ms)&#39;</span><span class="p">)</span>
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;BPF&#39;</span><span class="p">)</span>
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">40</span><span class="p">,</span><span class="mi">350</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;k:&#39;</span><span class="p">)</span>
</span></code></pre></div>
<p><img alt="Image title" src="../../images/speech_tutorial_5.png" /></p>
<p>We then apply this custom BPF to the original file, using <code>cleese.process_data(PhaseVocoder, wave_in, config_file, sample_rate=sr, BPF=bpf)</code> (passing audio data as input, because we don't need batch mode here). </p>
<div class="language-python highlight"><span class="filename">apply bpf</span><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="n">config_file</span> <span class="o">=</span> <span class="s2">&quot;./configs/random_pitch_profile.toml&quot;</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="c1"># CLEESE</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="n">bpf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">bpf_times</span><span class="p">,</span><span class="n">bpf_val</span><span class="p">))</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="n">wave_out</span><span class="p">,</span><span class="n">bpf_out</span> <span class="o">=</span> <span class="n">cleese</span><span class="o">.</span><span class="n">process_data</span><span class="p">(</span><span class="n">PhaseVocoder</span><span class="p">,</span> <span class="n">wave_in</span><span class="p">,</span> <span class="n">config_file</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span> <span class="n">BPF</span><span class="o">=</span><span class="n">bpf</span><span class="p">)</span>
</span></code></pre></div>
<p><audio controls src="../sounds/male_vraiment_flattened.wav"></audio><br>
<a href="../sounds/male_vraiment_flattened.wav"> Download audio </a></p>
<p>Compare pitch profile before and after transformation: </p>
<div class="language-py highlight"><span class="filename">display resulting pitch</span><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1"># display transformed file</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="n">times_out</span><span class="p">,</span><span class="n">pitch_out</span> <span class="o">=</span> <span class="n">PhaseVocoder</span><span class="o">.</span><span class="n">extract_pitch</span><span class="p">(</span><span class="n">wave_out</span><span class="p">,</span><span class="n">sr</span><span class="p">,</span> <span class="n">win</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">])</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times_in</span><span class="p">,</span> <span class="n">pitch_in</span><span class="p">,</span> <span class="s1">&#39;k:&#39;</span><span class="p">)</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times_out</span><span class="p">,</span> <span class="n">pitch_out</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time in file (ms)&#39;</span><span class="p">)</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;pitch (Hz)&#39;</span><span class="p">)</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">80</span><span class="p">,</span><span class="mi">120</span><span class="p">])</span>
</span></code></pre></div>
<p><img alt="Image title" src="../../images/speech_tutorial_6.png" /></p>
<h3 id="using-custom-breakpoints">Using custom breakpoints<a class="headerlink" href="#using-custom-breakpoints" title="Permanent link">&para;</a></h3>
<p>Instead of generating linearly spaced time windows (or, as called here, breakpoints), CLEESE supports a list of externally provided time positions. To demonstrate this, we use CLEESE to stretch the duration of each note in the song "Joyeux Anniversaire" (which we already used above). </p>
<p><audio controls src="../sounds/female_anniversaire_isochrone.wav"></audio><br>
<a href="../sounds/female_anniversaire_isochrone.wav"> Download audio </a></p>
<p>To find note boundaries, we can e.g. use an external audio editor such as <a href="https://www.audacityteam.org">Audacity</a>, and measure time positions between notes as <code>[0.027, 0.634, 1.137, 1.647, 2.185, 2.649, 3.181]</code>.</p>
<p><img alt="Image title" src="../../images/speech_tutorial_7.png" /></p>
<p>We can then generate a breakpoint function with <code>cleese.create_BPF</code> which uses these time points and parameters loaded from the stretch config file <code>config_file</code>. This BPF can then be passed to <code>cleese.process_data</code> as argument. </p>
<div class="language-python highlight"><span class="filename">process with custom breakpoints</span><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="n">input_file</span> <span class="o">=</span> <span class="s2">&quot;./sounds/female_anniversaire_isochrone.wav&quot;</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="n">config_file</span> <span class="o">=</span> <span class="s2">&quot;./configs/random_speed_profile.toml&quot;</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="n">wave_in</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">PhaseVocoder</span><span class="o">.</span><span class="n">wav_read</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="n">time_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.027</span><span class="p">,</span> <span class="mf">0.634</span><span class="p">,</span> <span class="mf">1.137</span><span class="p">,</span> <span class="mf">1.647</span><span class="p">,</span> <span class="mf">2.185</span><span class="p">,</span> <span class="mf">2.649</span><span class="p">,</span> <span class="mf">3.181</span><span class="p">])</span> <span class="c1"># values found in audacity</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="n">num_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_points</span><span class="p">)</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="n">bpf</span> <span class="o">=</span> <span class="n">PhaseVocoder</span><span class="o">.</span><span class="n">create_BPF</span><span class="p">(</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>    <span class="s1">&#39;stretch&#39;</span><span class="p">,</span><span class="n">config_file</span><span class="p">,</span><span class="n">time_points</span><span class="p">,</span><span class="n">num_points</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>   
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="n">wave_out</span><span class="p">,</span><span class="n">bpf_out</span> <span class="o">=</span> <span class="n">cleese</span><span class="o">.</span><span class="n">process_data</span><span class="p">(</span>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>    <span class="n">PhaseVocoder</span><span class="p">,</span> <span class="n">wave_in</span><span class="p">,</span> <span class="n">config_file</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span> <span class="n">BPF</span><span class="o">=</span><span class="n">bpf</span><span class="p">)</span>
</span></code></pre></div>
<p>The resulting file has random duration, but these changes of pace are aligned with note boundaries. </p>
<p><audio controls src="../sounds/female_anniversaire_isochrone_transformed_2.wav"></audio><br>
<a href="../sounds/female_anniversaire_isochrone_transformed_2.wav"> Download audio </a></p>
<div class="language-py highlight"><span class="filename">display pitch before/after</span><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="n">times_in</span><span class="p">,</span><span class="n">pitch_in</span> <span class="o">=</span> <span class="n">PhaseVocoder</span><span class="o">.</span><span class="n">extract_pitch</span><span class="p">(</span><span class="n">wave_in</span><span class="p">,</span><span class="n">sr</span><span class="p">)</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times_in</span><span class="p">,</span> <span class="n">pitch_in</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time in file (ms)&#39;</span><span class="p">)</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;pitch&#39;</span><span class="p">)</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="c1"># display transformed file</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="n">times_out</span><span class="p">,</span><span class="n">pitch_out</span> <span class="o">=</span> <span class="n">PhaseVocoder</span><span class="o">.</span><span class="n">extract_pitch</span><span class="p">(</span><span class="n">wave_out</span><span class="p">,</span><span class="n">sr</span><span class="p">)</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times_out</span><span class="p">,</span> <span class="n">pitch_out</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time in file (ms)&#39;</span><span class="p">)</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;pitch&#39;</span><span class="p">)</span>
</span></code></pre></div>
<p><img alt="Image title" src="../../images/speech_tutorial_8.png" /></p>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">May 10, 2024</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">January 26, 2022</span>
  </span>

    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../api/face-warp/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Face Warp">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Face Warp
              </div>
            </div>
          </a>
        
        
          
          <a href="../face/" class="md-footer__link md-footer__link--next" aria-label="Next: Random faces">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Random faces
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 -- FEMTO Neuro Group
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.action.edit", "navigation.tabs", "navigation.footer"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
        <script src="../../javascripts/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>